<<<<<<< HEAD
# æ™ºæ…§ç‰©è”ç½‘ç›‘æŽ§å°ç¨‹åº

åŸºäºŽMQTTåè®®çš„å¾®ä¿¡å°ç¨‹åº,æ”¯æŒå¤šç§ä¼ æ„Ÿå™¨æŽ¥å…¥å’Œè®¾å¤‡æŽ§åˆ¶,æ•°æ®äº‘ç«¯åŒæ­¥ã€‚

## ðŸ“‹ ç›®å½•

- [é¡¹ç›®ä»‹ç»](#é¡¹ç›®ä»‹ç»)
- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
- [ä½¿ç”¨è¯´æ˜Ž](#ä½¿ç”¨è¯´æ˜Ž)
- [é¡¹ç›®ç»“æž„](#é¡¹ç›®ç»“æž„)
- [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)

## ðŸŽ¯ é¡¹ç›®ä»‹ç»

è¿™æ˜¯ä¸€ä¸ªåŸºäºŽMQTTåè®®çš„å¾®ä¿¡å°ç¨‹åºç‰©è”ç½‘ç›‘æŽ§ç³»ç»Ÿ,æ”¯æŒ:
- å¤šç§ä¼ æ„Ÿå™¨æ•°æ®å®žæ—¶ç›‘æŽ§(æ¸©åº¦ã€æ¹¿åº¦ã€æ°´è´¨ã€åœŸå£¤ã€é£Žé€Ÿç­‰)
- è¿œç¨‹è®¾å¤‡æŽ§åˆ¶(å¼€å…³ã€LEDç¯å¸¦ã€ç”µæœºç­‰)
- åŽ†å²æ•°æ®å›¾è¡¨å±•ç¤º
- å¾®ä¿¡ç™»å½•,æ•°æ®äº‘ç«¯åŒæ­¥
- å¤šç«¯æ•°æ®è‡ªåŠ¨åŒæ­¥(æ¢è®¾å¤‡æ— éœ€é‡æ–°é…ç½®)

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### 1. ä¼ æ„Ÿå™¨ç›‘æŽ§
- âœ… æ¸©åº¦ä¼ æ„Ÿå™¨
- âœ… æ¹¿åº¦ä¼ æ„Ÿå™¨
- âœ… æ°´è´¨ä¼ æ„Ÿå™¨(TDS)
- âœ… åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨
- âœ… é£Žé€Ÿä¼ æ„Ÿå™¨
- âœ… 24å°æ—¶/7å¤©åŽ†å²æ•°æ®å›¾è¡¨

### 2. è®¾å¤‡æŽ§åˆ¶
- âœ… å¼€å…³è®¾å¤‡æŽ§åˆ¶
- âœ… WS2812B LEDç¯å¸¦é¢œè‰²/äº®åº¦æŽ§åˆ¶
- âœ… ä¼ºæœç”µæœº/é©¬è¾¾æŽ§åˆ¶

### 3. æ•°æ®åŒæ­¥
- âœ… å¾®ä¿¡ä¸€é”®ç™»å½•
- âœ… MQTTé…ç½®äº‘ç«¯å­˜å‚¨
- âœ… è®¾å¤‡åˆ—è¡¨äº‘ç«¯åŒæ­¥
- âœ… å¤šç«¯æ•°æ®è‡ªåŠ¨åŒæ­¥

## ðŸ›  æŠ€æœ¯æ ˆ

### å‰ç«¯(å°ç¨‹åº)
- å¾®ä¿¡å°ç¨‹åºåŽŸç”Ÿå¼€å‘
- MQTT.js å®¢æˆ·ç«¯
- Canvas å›¾è¡¨ç»˜åˆ¶

### åŽç«¯
- Node.js + Express
- MySQL æ•°æ®åº“
- RESTful API

### é€šä¿¡åè®®
- MQTT (WebSocket)
- HTTP/HTTPS

## ðŸš€ å¿«é€Ÿå¼€å§‹

### 1. çŽ¯å¢ƒå‡†å¤‡

#### å¿…éœ€è½¯ä»¶:
- [Node.js](https://nodejs.org/) (v14+)
- [MySQL](https://dev.mysql.com/downloads/mysql/) (v5.7+)
- [å¾®ä¿¡å¼€å‘è€…å·¥å…·](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)

### 2. æ•°æ®åº“é…ç½®

#### æ­¥éª¤1: åˆ›å»ºæ•°æ®åº“

```bash
# ç™»å½•MySQL
mysql -u root -p

# æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬
source F:\xiaochengxu\database\init.sql
```

æˆ–è€…ç›´æŽ¥åœ¨MySQLå®¢æˆ·ç«¯ä¸­æ‰§è¡Œ `database/init.sql` æ–‡ä»¶ã€‚

#### æ­¥éª¤2: ä¿®æ”¹æ•°æ®åº“é…ç½®

ç¼–è¾‘ `server/config/db.js`:
```javascript
const dbConfig = {
    host: 'localhost',
    user: 'root',
    password: 'your_password',  // ä¿®æ”¹ä¸ºæ‚¨çš„MySQLå¯†ç 
    database: 'iot_miniapp',
    // ...
};
```

### 3. åŽç«¯æœåŠ¡å™¨å¯åŠ¨

```bash
# è¿›å…¥æœåŠ¡å™¨ç›®å½•
cd server

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨æœåŠ¡å™¨
npm start

# æˆ–è€…å¼€å‘æ¨¡å¼(è‡ªåŠ¨é‡å¯)
npm run dev
```

å¯åŠ¨æˆåŠŸåŽ,ä¼šæ˜¾ç¤º:
```
========================================
  æ™ºæ…§ç‰©è”ç½‘ç›‘æŽ§å°ç¨‹åºåŽç«¯æœåŠ¡
========================================
ðŸš€ æœåŠ¡å™¨å·²å¯åŠ¨: http://localhost:3000
ðŸ“ APIæ–‡æ¡£: http://localhost:3000
ðŸ’š å¥åº·æ£€æŸ¥: http://localhost:3000/health
========================================
```

### 4. å°ç¨‹åºé…ç½®

#### æ­¥éª¤1: ä¿®æ”¹APIåœ°å€

ç¼–è¾‘ `utils/api.js`:
```javascript
// æ ¹æ®å®žé™…æƒ…å†µä¿®æ”¹åŽç«¯æœåŠ¡å™¨åœ°å€
const API_BASE_URL = 'http://localhost:3000/api';
// æˆ–è€…ä½¿ç”¨æ‚¨çš„æœåŠ¡å™¨åŸŸå
// const API_BASE_URL = 'https://yourdomain.com/api';
```

#### æ­¥éª¤2: é…ç½®å°ç¨‹åºAppID

1. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·
2. å¯¼å…¥é¡¹ç›®,é€‰æ‹©é¡¹ç›®ç›®å½• `F:\xiaochengxu`
3. å¡«å†™æ‚¨çš„å°ç¨‹åºAppID(æµ‹è¯•å¯é€‰"æµ‹è¯•å·")

#### æ­¥éª¤3: é…ç½®æœåŠ¡å™¨åŸŸå(æ­£å¼çŽ¯å¢ƒ)

åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°åŽå°é…ç½®:
- requeståˆæ³•åŸŸå: `https://yourdomain.com`
- socketåˆæ³•åŸŸå: `wss://your-mqtt-server.com`

### 5. è¿è¡Œå°ç¨‹åº

1. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ç‚¹å‡»"ç¼–è¯‘"
2. é¦–æ¬¡è¿è¡Œä¼šè¿›å…¥ç™»å½•é¡µé¢
3. ç‚¹å‡»"å¾®ä¿¡ä¸€é”®ç™»å½•"æŽˆæƒç™»å½•
4. å¼€å§‹ä½¿ç”¨!

## ðŸ“– ä½¿ç”¨è¯´æ˜Ž

### é¦–æ¬¡ä½¿ç”¨æµç¨‹

1. **å¾®ä¿¡ç™»å½•**
   - æ‰“å¼€å°ç¨‹åº,ç‚¹å‡»"å¾®ä¿¡ä¸€é”®ç™»å½•"
   - æŽˆæƒèŽ·å–ç”¨æˆ·ä¿¡æ¯

2. **é…ç½®MQTTæœåŠ¡å™¨**
   - åœ¨è®¾ç½®é¡µé¢è¾“å…¥MQTTæœåŠ¡å™¨ä¿¡æ¯:
     - æœåŠ¡å™¨åœ°å€ (å¦‚: `mqtt.example.com`)
     - ç”¨æˆ·å
     - å¯†ç 
   - ç‚¹å‡»"ä¿å­˜"(ä¼šè‡ªåŠ¨åŒæ­¥åˆ°äº‘ç«¯)

3. **æ·»åŠ è®¾å¤‡**
   - è¿›å…¥"è®¾å¤‡ç®¡ç†"é¡µé¢
   - ç‚¹å‡»"æ·»åŠ è®¾å¤‡"
   - é€‰æ‹©è®¾å¤‡ç±»åž‹
   - å¡«å†™è®¾å¤‡åç§°å’Œä¸»é¢˜ä¿¡æ¯
   - ä¿å­˜(ä¼šè‡ªåŠ¨åŒæ­¥åˆ°äº‘ç«¯)

4. **æŸ¥çœ‹æ•°æ®**
   - è¿”å›žé¦–é¡µ,æŸ¥çœ‹è®¾å¤‡å®žæ—¶æ•°æ®
   - ç‚¹å‡»è®¾å¤‡å¡ç‰‡æŸ¥çœ‹åŽ†å²æ•°æ®å›¾è¡¨
   - æŽ§åˆ¶è®¾å¤‡(å¼€å…³ã€ç¯å¸¦ã€ç”µæœº)

### æ¢è®¾å¤‡ä½¿ç”¨

å½“æ‚¨æ¢äº†æ–°æ‰‹æœºæˆ–é‡æ–°å®‰è£…å°ç¨‹åº:
1. ç›´æŽ¥å¾®ä¿¡ç™»å½•
2. ç³»ç»Ÿè‡ªåŠ¨ä»Žäº‘ç«¯åŒæ­¥æ‚¨çš„æ‰€æœ‰é…ç½®å’Œè®¾å¤‡
3. æ— éœ€é‡æ–°é…ç½®,ç›´æŽ¥ä½¿ç”¨!

## ðŸ“ é¡¹ç›®ç»“æž„

```
xiaochengxu/
â”œâ”€â”€ pages/                  # å°ç¨‹åºé¡µé¢
â”‚   â”œâ”€â”€ login/             # ç™»å½•é¡µé¢
â”‚   â”œâ”€â”€ index/             # ä¸»é¡µ(è®¾å¤‡ç›‘æŽ§)
â”‚   â”œâ”€â”€ mqtt/              # MQTTé…ç½®é¡µé¢
â”‚   â”œâ”€â”€ device/            # è®¾å¤‡ç®¡ç†é¡µé¢
â”‚   â””â”€â”€ view/              # æ•°æ®æŸ¥çœ‹é¡µé¢
â”œâ”€â”€ utils/                  # å·¥å…·æ–‡ä»¶
â”‚   â”œâ”€â”€ api.js             # APIæŽ¥å£å°è£…
â”‚   â”œâ”€â”€ mqtt.min.js        # MQTTå®¢æˆ·ç«¯åº“
â”‚   â””â”€â”€ util.js            # é€šç”¨å·¥å…·å‡½æ•°
â”œâ”€â”€ images/                 # å›¾ç‰‡èµ„æº
â”œâ”€â”€ server/                 # åŽç«¯æœåŠ¡å™¨
â”‚   â”œâ”€â”€ app.js             # æœåŠ¡å™¨å…¥å£
â”‚   â”œâ”€â”€ config/            # é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ db.js          # æ•°æ®åº“é…ç½®
â”‚   â”œâ”€â”€ controllers/       # æŽ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ userController.js    # ç”¨æˆ·æŽ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ deviceController.js  # è®¾å¤‡æŽ§åˆ¶å™¨
â”‚   â”œâ”€â”€ routes/            # è·¯ç”±
â”‚   â”‚   â””â”€â”€ api.js         # APIè·¯ç”±
â”‚   â””â”€â”€ package.json       # ä¾èµ–é…ç½®
â”œâ”€â”€ database/              # æ•°æ®åº“æ–‡ä»¶
â”‚   â”œâ”€â”€ init.sql          # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”‚   â””â”€â”€ README.md         # æ•°æ®åº“é…ç½®è¯´æ˜Ž
â”œâ”€â”€ app.js                 # å°ç¨‹åºå…¥å£
â”œâ”€â”€ app.json              # å°ç¨‹åºé…ç½®
â””â”€â”€ README.md             # é¡¹ç›®è¯´æ˜Ž

```

## ðŸ—„ æ•°æ®åº“è¡¨ç»“æž„

### userinfo è¡¨(ç”¨æˆ·ä¿¡æ¯)
| å­—æ®µ | ç±»åž‹ | è¯´æ˜Ž |
|------|------|------|
| wx_id | VARCHAR(100) | å¾®ä¿¡openid(ä¸»é”®) |
| nickname | VARCHAR(100) | å¾®ä¿¡æ˜µç§° |
| avatar_url | VARCHAR(255) | å¾®ä¿¡å¤´åƒ |
| ip | VARCHAR(255) | MQTTæœåŠ¡å™¨åœ°å€ |
| username | VARCHAR(100) | MQTTç”¨æˆ·å |
| password | VARCHAR(255) | MQTTå¯†ç (åŠ å¯†) |

### device_info è¡¨(è®¾å¤‡ä¿¡æ¯)
| å­—æ®µ | ç±»åž‹ | è¯´æ˜Ž |
|------|------|------|
| device_id | VARCHAR(50) | è®¾å¤‡ID |
| wx_id | VARCHAR(100) | ç”¨æˆ·å¾®ä¿¡ID(å¤–é”®) |
| name | VARCHAR(100) | è®¾å¤‡åç§° |
| type | VARCHAR(50) | è®¾å¤‡ç±»åž‹ |
| topic | VARCHAR(255) | è®¢é˜…ä¸»é¢˜ |
| publish_topic | VARCHAR(255) | å‘å¸ƒä¸»é¢˜ |
| on_command | VARCHAR(255) | å¼€å¯å‘½ä»¤ |
| off_command | VARCHAR(255) | å…³é—­å‘½ä»¤ |

## ðŸ” å®‰å…¨è¯´æ˜Ž

1. **å¯†ç åŠ å¯†**: MQTTå¯†ç ä½¿ç”¨SHA256åŠ å¯†å­˜å‚¨
2. **æ•°æ®éš”ç¦»**: æ¯ä¸ªç”¨æˆ·çš„æ•°æ®é€šè¿‡wx_idå®Œå…¨éš”ç¦»
3. **ç”Ÿäº§çŽ¯å¢ƒå»ºè®®**:
   - ä½¿ç”¨HTTPSåè®®
   - é…ç½®æ•°æ®åº“é˜²ç«å¢™
   - ä½¿ç”¨å¼ºå¯†ç 
   - å®šæœŸå¤‡ä»½æ•°æ®

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å¾®ä¿¡å°ç¨‹åºé™åˆ¶**
   - å¿…é¡»ä½¿ç”¨wss://åè®®è¿žæŽ¥MQTTæœåŠ¡å™¨
   - éœ€è¦åœ¨å°ç¨‹åºåŽå°é…ç½®æœåŠ¡å™¨åŸŸå
   - æœ¬åœ°å¼€å‘æ—¶éœ€å¼€å¯"ä¸æ ¡éªŒåˆæ³•åŸŸå"

2. **MQTTæœåŠ¡å™¨è¦æ±‚**
   - æ”¯æŒWebSocketåè®®(ç«¯å£é€šå¸¸ä¸º8083æˆ–8084)
   - å»ºè®®ä½¿ç”¨EMQXã€Mosquittoç­‰å¼€æºMQTTæœåŠ¡å™¨

3. **æ•°æ®å­˜å‚¨**
   - åŽ†å²æ•°æ®ä»…ä¿å­˜7å¤©(å¯åœ¨ä»£ç ä¸­ä¿®æ”¹)
   - è®¾å¤‡çŠ¶æ€æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°å’Œäº‘ç«¯åŒå¤‡ä»½

4. **åŽç«¯éƒ¨ç½²**
   - ç”Ÿäº§çŽ¯å¢ƒå»ºè®®ä½¿ç”¨PM2è¿›ç¨‹ç®¡ç†
   - é…ç½®Nginxåå‘ä»£ç†
   - ä½¿ç”¨HTTPSè¯ä¹¦

## ðŸ”§ å¸¸è§é—®é¢˜

### Q: ç™»å½•åŽæç¤º"ç™»å½•å¤±è´¥"?
A: æ£€æŸ¥åŽç«¯æœåŠ¡å™¨æ˜¯å¦å¯åŠ¨,æ•°æ®åº“æ˜¯å¦è¿žæŽ¥æˆåŠŸã€‚

### Q: MQTTè¿žæŽ¥å¤±è´¥?
A: 
1. æ£€æŸ¥MQTTæœåŠ¡å™¨åœ°å€æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ä½¿ç”¨wss://åè®®
3. æ£€æŸ¥ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®

### Q: æ•°æ®ä¸åŒæ­¥?
A: 
1. ç¡®è®¤å·²ç™»å½•
2. æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
3. æŸ¥çœ‹æŽ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯

### Q: æ¢è®¾å¤‡åŽæ•°æ®ä¸¢å¤±?
A: åªè¦ä½¿ç”¨ç›¸åŒå¾®ä¿¡å·ç™»å½•,æ•°æ®ä¼šè‡ªåŠ¨ä»Žäº‘ç«¯åŒæ­¥ã€‚

## ðŸ“ å¼€å‘è®¡åˆ’

- [ ] æ”¯æŒæ•°æ®å¯¼å‡ºåŠŸèƒ½
- [ ] æ·»åŠ è®¾å¤‡åˆ†ç»„ç®¡ç†
- [ ] æ”¯æŒè®¾å¤‡åˆ†äº«ç»™å…¶ä»–ç”¨æˆ·
- [ ] æ·»åŠ å¼‚å¸¸æŠ¥è­¦åŠŸèƒ½
- [ ] æ”¯æŒè¯­éŸ³æŽ§åˆ¶

## ðŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ã€‚

## ðŸ‘¨â€ðŸ’» è´¡çŒ®

æ¬¢è¿Žæäº¤Issueå’ŒPull Request!

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«! ðŸŽ‰**

=======
>åŸºäºŽMQTTåè®®å¾®ä¿¡å°ç¨‹åº`4.0`å…¨é‡å‘å¸ƒã€‚æ”¯æŒå¤šç§è®¾å¤‡æŽ¥å…¥ï¼Œè½»æ¾æ–¹ä¾¿å®žçŽ°è¿œæŽ§æŽ§åˆ¶è®¾å¤‡ã€‚

# æ”¯æŒè®¾å¤‡
- æ”¯æŒæ¸©åº¦ã€æ¹¿åº¦æ•°æ®æŽ¥å…¥ã€‚
- æ”¯æŒå¼€å…³è®¾å¤‡æŽ¥å…¥ã€‚
- æ”¯æŒæ°´è´¨ã€åœŸå£¤ã€é£Žé€Ÿç­‰ä¼ æ„Ÿå™¨æŽ¥å…¥ã€‚
- æ”¯æŒ`Ws2812b`ç¯å¸¦æŽ¥å…¥å’ŒæŽ§åˆ¶ã€‚
- æ”¯æŒå¯¹ä¼ºæœç”µæœºã€é©¬è¾¾è®¾å¤‡æŽ§åˆ¶ã€‚


# æ•°æ®è¯´æ˜Ž
ç›®å‰æ‰€æœ‰æ•°æ®ä¼˜å…ˆæ”¯æŒ`json`æ•°æ®ã€‚éƒ¨åˆ†è®¾å¤‡ç±»åž‹æ”¯æŒå‘½ä»¤ã€‚

**æ¸©æ¹¿åº¦**
```
{"humi":42,"temp":5}
```
**å¼€å…³ç±»**
```
#å¼€ç¯
{"led": true}
#å…³ç¯
{"led": false}
```
å¯¹äºŽå¼€å…³ç±»åž‹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŽ§åˆ¶ä¼ºæœèˆµæœºæŒ‰å¯¹åº”è§’åº¦æ—‹è½¬ã€‚
```
#æ—‹è½¬90Â°
servo90
#æ—‹è½¬å¤ä½
servo0
```
å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥å‘é€`1`æˆ–è€…`0`å®žçŽ°å¯¹è®¾å¤‡çš„å¼€å¯/å…³é—­ã€‚ä½†éœ€è¦å†™å¥½ç›¸å…³æŽ§åˆ¶ä»£ç ã€‚

**æ°´è´¨ä¼ æ„Ÿå™¨**

æ•°æ®æ ¼å¼ï¼š
```
{"TDS":21,"DJ":"ä¼˜"}
```

**é£Žé€Ÿä¼ æ„Ÿå™¨**

æž„å»ºæ•°æ®æ ¼å¼ä¸ºï¼š
```
{"FS":1.3,"FDJ":"è½»é£Ž"}
```
**åœŸå£¤ä¼ æ„Ÿå™¨**
```
{"TR":1.3"}
```
å½“ç„¶ï¼Œå¯ä»¥å°†æ•°æ®æ•´åˆã€‚å®Œæ•´çš„æ•°æ®æ ¼å¼ç¤ºä¾‹ï¼š
```
{"humi": 35, "temp": 20.20,"TDS":21,"DJ":"ä¼˜","FS":1.3,"FDJ":"è½»é£Ž","TR":1.3}
```

![](https://xiaoyaozi666.oss-cn-beijing.aliyuncs.com/image_20251018190614.png)

**Ws2812bç¯å¸¦æŽ§åˆ¶** 
```
# å¼€ç¯
{"state":"ON"}
# å…³ç¯
{"state":"OFF"}
# é¢œè‰²è®¾ç½®
{"color":{"r":155,"g":158,"b":243}}
# äº®åº¦
{"state":"ON"}
```
è§†é¢‘æ•ˆæžœæ¼”ç¤º

1

**é©¬è¾¾æŽ§åˆ¶**

å‘å¯¹åº”çš„ä¸»é¢˜å‘é€`{"on":"1", "duration":5} ` è¡¨ç¤ºç”µæœºæ­£è½¬5s ã€‚å‘é€ `{"on":"0", "duration":5} `è¡¨ç¤ºåè½¬5s ï¼Œè‹¥`durationä¸º0`åˆ™è¡¨ç¤ºä¸€ç›´è¿è¡Œã€‚`{"on":"1", "duration":0}`æˆ– `{"on":"1"}`è¡¨ç¤ºä¸€ç›´æ­£è½¬ã€‚`{"on":"0", "duration":0}`æˆ–`{"on":"0"}`è¡¨ç¤ºä¸€ç›´åè½¬ã€‚å‘é€`{"off":true}`è¡¨ç¤ºåœæ­¢è½¬åŠ¨ã€‚


![](https://xiaoyaozi666.oss-cn-beijing.aliyuncs.com/image_20251018191147.png)

ç”µæœºæŽ§åˆ¶ï¼Œæ”¯æŒå¿«æ·æŒ‰é’®ï¼ˆæ­£è½¬5sã€åè½¬5sã€æŒç»­æ­£è½¬ã€æŒç»­åè½¬ï¼‰å’Œç”¨æˆ·è‡ªå®šä¹‰æŽ§åˆ¶ä¸¤éƒ¨åˆ†ã€‚

å¦‚æžœè¦ä¿®æ”¹å¿«æ·æ—¶é—´5sä¸º10sï¼Œå¯ä»¥ä¿®æ”¹`pages/index/index.js`æ–‡ä»¶ä¸­çš„`motorDuration: 5 `å‚æ•°ã€‚


![](https://xiaoyaozi666.oss-cn-beijing.aliyuncs.com/image_20251018191657.png)

è§†é¢‘æ¼”ç¤ºæ•ˆæžœ

1
# ä¸ŽHomeAssistantåŒæ­¥
å› ä¸ºæ˜¯åŸºäºŽMQTTåè®®ï¼Œå€¼å¾—é«˜å…´çš„æ˜¯ï¼Œä½ çš„è®¾å¤‡å¯ä»¥ä¸ŽHAå…±åŒåè°ƒã€‚

![HAä¸­æŽ§åˆ¶ç”µæœº](https://xiaoyaozi666.oss-cn-beijing.aliyuncs.com/image_20251018191959.png)


![](https://xiaoyaozi666.oss-cn-beijing.aliyuncs.com/image_20251018192236.png)


![æ¸©æ¹¿åº¦æ•ˆæžœ](https://xiaoyaozi666.oss-cn-beijing.aliyuncs.com/image_20251018192049.png)


![Ws2812bç¯å¸¦æŽ§åˆ¶-](https://xiaoyaozi666.oss-cn-beijing.aliyuncs.com/image_20251018192118.png)

# æ³¨æ„äº‹é¡¹
- åŠ¡å¿…ä¿®æ”¹ä¸ºè‡ªå·±çš„appid
- åŠ¡å¿…æ­å»ºè‡ªå·±çš„MQTTæœåŠ¡å™¨å¹¶é…ç½®wss
- éœ€è¦å¤‡æ¡ˆåŸŸå

# è¯¦æƒ…è®¿é—®å¾®ä¿¡å…¬ä¼—å· Kaliç¬”è®°
>>>>>>> a83a60444d083c894cf8433ba6f0219844e197de
